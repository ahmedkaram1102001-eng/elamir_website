<div class="dashboard-container" dir="rtl">
  
  <!-- ๐จ Header ุงูุฌุฐุงุจ -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="header-text">
        <h1>๐ฏ ููุญุฉ ุงูุชุญูู</h1>
        <p>ูุฑุญุจุงู ุจู ูู ูุธุงู ุฅุฏุงุฑุฉ ุงูุชูุธูู - Alamir Group</p>
      </div>
      <div class="header-actions">
        <button class="header-btn">
          <i class="fas fa-bell"></i>
          <span class="badge">{{ stats.pending }}</span>
        </button>
        <button class="header-btn">
          <i class="fas fa-user-circle"></i>
        </button>
      </div>
    </div>
  </header>

  <div class="dashboard-content">
    
    <!-- ๐ Progress Bar ุงูุงุญุชุฑุงูู -->
    <div class="progress-section">
      <h2 class="section-title">
        <i class="fas fa-chart-line"></i>
        ุฅุญุตุงุฆูุงุช ุงูุทูุจุงุช
      </h2>
      
      <div class="progress-container">
        <!-- Total Applications -->
        <div class="progress-item">
          <div class="progress-header">
            <span class="progress-label">
              <i class="fas fa-users"></i>
              ุฅุฌูุงูู ุงูุทูุจุงุช
            </span>
            <span class="progress-value">{{ stats.total }}</span>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar-bg">
              <div class="progress-bar total" [style.width]="'100%'">
                <span class="progress-percentage">100%</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Pending Applications -->
        <div class="progress-item">
          <div class="progress-header">
            <span class="progress-label">
              <i class="fas fa-clock"></i>
              ููุฏ ุงููุฑุงุฌุนุฉ
            </span>
            <span class="progress-value">{{ stats.pending }}</span>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar-bg">
              <div class="progress-bar pending" 
                   [style.width]="stats.total > 0 ? (stats.pending / stats.total * 100) + '%' : '0%'">
                <span class="progress-percentage">
                  {{ stats.total > 0 ? (stats.pending / stats.total * 100).toFixed(0) : 0 }}%
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Approved Applications -->
        <div class="progress-item">
          <div class="progress-header">
            <span class="progress-label">
              <i class="fas fa-check-circle"></i>
              ุงูููุจูููู
            </span>
            <span class="progress-value">{{ stats.approved }}</span>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar-bg">
              <div class="progress-bar approved" 
                   [style.width]="stats.total > 0 ? (stats.approved / stats.total * 100) + '%' : '0%'">
                <span class="progress-percentage">
                  {{ stats.total > 0 ? (stats.approved / stats.total * 100).toFixed(0) : 0 }}%
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Rejected Applications -->
        <div class="progress-item">
          <div class="progress-header">
            <span class="progress-label">
              <i class="fas fa-times-circle"></i>
              ุงููุฑููุถูู
            </span>
            <span class="progress-value">{{ stats.rejected }}</span>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar-bg">
              <div class="progress-bar rejected" 
                   [style.width]="stats.total > 0 ? (stats.rejected / stats.total * 100) + '%' : '0%'">
                <span class="progress-percentage">
                  {{ stats.total > 0 ? (stats.rejected / stats.total * 100).toFixed(0) : 0 }}%
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ๐ฏ ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช -->
    <div class="action-buttons">
      <button class="action-btn job-btn" (click)="showJobModal = true">
        <i class="fas fa-briefcase"></i>
        <span>ุฅุถุงูุฉ ูุธููุฉ ุฌุฏูุฏุฉ</span>
      </button>
      <button class="action-btn congrat-btn" (click)="showCongratModal = true">
        <i class="fas fa-trophy"></i>
        <span>ุฅุถุงูุฉ ุชููุฆุฉ</span>
      </button>
    </div>

    <!-- ๐ ูุงุฆูุฉ ุงูุทูุจุงุช -->
    <div class="applications-section">
      <h2 class="section-title">
        <i class="fas fa-file-alt"></i>
        ุทูุจุงุช ุงูุชูุธูู
        <span class="count-badge">{{ applications.length }}</span>
      </h2>

      <div class="applications-grid">
        <div class="application-card" *ngFor="let app of applications">
          <div class="card-header">
            <div class="applicant-info">
              <div class="avatar">
                {{ app.firstName.charAt(0) }}{{ app.lastName.charAt(0) }}
              </div>
              <div>
                <h3>{{ app.firstName }} {{ app.lastName }}</h3>
                <p class="position">{{ app.position }}</p>
              </div>
            </div>
            <span class="status-badge" [ngClass]="getStatusColor(app.status)">
              {{ getStatusText(app.status) }}
            </span>
          </div>

          <div class="card-body">
            <div class="info-row">
              <i class="fas fa-envelope"></i>
              <span>{{ app.email }}</span>
            </div>
            <div class="info-row">
              <i class="fas fa-phone"></i>
              <span>{{ app.phone }}</span>
            </div>
            <div class="info-row">
              <i class="fas fa-calendar"></i>
              <span>{{ formatDate(app.date) }}</span>
            </div>
            <div class="info-row">
              <i class="fas fa-paperclip"></i>
              <span>{{ app.cv }}</span>
            </div>
          </div>

          <div class="card-footer">
            <button class="details-btn" (click)="viewApplicationDetails(app)">
              <i class="fas fa-eye"></i>
              ุนุฑุถ ุงูุชูุงุตูู
            </button>
            
            <div class="action-btns" *ngIf="app.status === 'pending'">
              <button class="approve-btn" (click)="handleStatusChange(app.id, 'approved')">
                <i class="fas fa-check"></i>
                ูุจูู
              </button>
              <button class="reject-btn" (click)="handleStatusChange(app.id, 'rejected')">
                <i class="fas fa-times"></i>
                ุฑูุถ
              </button>
            </div>

            <button class="delete-btn" (click)="deleteApplication(app.id)">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="applications.length === 0">
        <i class="fas fa-inbox"></i>
        <h3>ูุง ุชูุฌุฏ ุทูุจุงุช ุญุงููุงู</h3>
        <p>ุณูุชู ุนุฑุถ ุทูุจุงุช ุงูุชูุธูู ููุง</p>
      </div>
    </div>
  </div>

  <!-- ๐ช Modal ุฅุถุงูุฉ ูุธููุฉ -->
  <div class="modal-overlay" *ngIf="showJobModal" (click)="closeJobModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2><i class="fas fa-briefcase"></i> ุฅุถุงูุฉ ูุธููุฉ ุฌุฏูุฏุฉ</h2>
        <button class="close-btn" (click)="closeJobModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label><i class="fas fa-heading"></i> ุนููุงู ุงููุธููุฉ</label>
          <input 
            type="text" 
            [(ngModel)]="jobForm.title"
            placeholder="ูุซุงู: ูููุฏุณ ุจุฑูุฌูุงุช"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label><i class="fas fa-align-left"></i> ูุตู ุงููุธููุฉ</label>
          <textarea 
            [(ngModel)]="jobForm.description"
            placeholder="ุงูุชุจ ูุตูุงู ุชูุตูููุงู ูููุธููุฉ..."
            rows="5"
            class="form-input"
          ></textarea>
        </div>

        <div class="form-group">
          <label><i class="fas fa-image"></i> ุตูุฑุฉ ุงููุธููุฉ (ุงุฎุชูุงุฑู)</label>
          <div class="upload-area" [class.has-preview]="jobImagePreview">
            <input 
              type="file" 
              id="jobImage"
              (change)="onJobImageSelected($event)"
              accept="image/*"
              hidden
            />
            <label for="jobImage" class="upload-label">
              <div *ngIf="!jobImagePreview" class="upload-placeholder">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>ุงุถุบุท ูุฑูุน ุตูุฑุฉ</p>
                <span>PNG, JPG ุญุชู 10MB</span>
              </div>
              <div *ngIf="jobImagePreview" class="image-preview">
                <img [src]="jobImagePreview" alt="Preview" />
                <div class="preview-overlay">
                  <i class="fas fa-sync-alt"></i>
                  <span>ุชุบููุฑ ุงูุตูุฑุฉ</span>
                </div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="cancel-btn" (click)="closeJobModal()">
          <i class="fas fa-times"></i> ุฅูุบุงุก
        </button>
        <button class="submit-btn" (click)="handleAddJob()">
          <i class="fas fa-check"></i> ุฅุถุงูุฉ ุงููุธููุฉ
        </button>
      </div>
    </div>
  </div>

  <!-- ๐ช Modal ุฅุถุงูุฉ ุชููุฆุฉ -->
  <div class="modal-overlay" *ngIf="showCongratModal" (click)="closeCongratModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header congrat-header">
        <h2><i class="fas fa-trophy"></i> ุฅุถุงูุฉ ุชููุฆุฉ ุฌุฏูุฏุฉ</h2>
        <button class="close-btn" (click)="closeCongratModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label><i class="fas fa-heading"></i> ุนููุงู ุงูุชููุฆุฉ</label>
          <input 
            type="text" 
            [(ngModel)]="congratForm.title"
            placeholder="ูุซุงู: ุชููุฆุฉ ุจุงูุนูุฏ"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label><i class="fas fa-align-left"></i> ูุต ุงูุชููุฆุฉ</label>
          <textarea 
            [(ngModel)]="congratForm.message"
            placeholder="ุงูุชุจ ูุต ุงูุชููุฆุฉ..."
            rows="5"
            class="form-input"
          ></textarea>
        </div>

        <div class="form-group">
          <label><i class="fas fa-image"></i> ุตูุฑุฉ ุงูุชููุฆุฉ (ุงุฎุชูุงุฑู)</label>
          <div class="upload-area" [class.has-preview]="congratImagePreview">
            <input 
              type="file" 
              id="congratImage"
              (change)="onCongratImageSelected($event)"
              accept="image/*"
              hidden
            />
            <label for="congratImage" class="upload-label">
              <div *ngIf="!congratImagePreview" class="upload-placeholder">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>ุงุถุบุท ูุฑูุน ุตูุฑุฉ</p>
                <span>PNG, JPG ุญุชู 10MB</span>
              </div>
              <div *ngIf="congratImagePreview" class="image-preview">
                <img [src]="congratImagePreview" alt="Preview" />
                <div class="preview-overlay">
                  <i class="fas fa-sync-alt"></i>
                  <span>ุชุบููุฑ ุงูุตูุฑุฉ</span>
                </div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="cancel-btn" (click)="closeCongratModal()">
          <i class="fas fa-times"></i> ุฅูุบุงุก
        </button>
        <button class="submit-btn congrat-submit" (click)="handleAddCongratulation()">
          <i class="fas fa-check"></i> ุฅุถุงูุฉ ุงูุชููุฆุฉ
        </button>
      </div>
    </div>
  </div>

  <!-- ๐ช Modal ุชูุงุตูู ุงูุทูุจ -->
  <div class="modal-overlay" *ngIf="showApplicationDetails && selectedApplication" (click)="closeApplicationDetails()">
    <div class="modal-container large" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2><i class="fas fa-user"></i> ุชูุงุตูู ุงููุชูุฏู</h2>
        <button class="close-btn" (click)="closeApplicationDetails()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body" *ngIf="selectedApplication">
        <div class="details-grid">
          <div class="detail-item">
            <label>ุงูุงุณู ุงููุงูู</label>
            <p>{{ selectedApplication.firstName }} {{ selectedApplication.lastName }}</p>
          </div>
          <div class="detail-item">
            <label>ุงููุธููุฉ ุงููุชูุฏู ููุง</label>
            <p>{{ selectedApplication.position }}</p>
          </div>
          <div class="detail-item">
            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <p>{{ selectedApplication.email }}</p>
          </div>
          <div class="detail-item">
            <label>ุฑูู ุงููุงุชู</label>
            <p>{{ selectedApplication.phone }}</p>
          </div>
          <div class="detail-item">
            <label>ุชุงุฑูุฎ ุงูุชูุฏูู</label>
            <p>{{ formatDate(selectedApplication.date) }}</p>
          </div>
          <div class="detail-item">
            <label>ุงูุญุงูุฉ</label>
            <p>
              <span class="status-badge" [ngClass]="getStatusColor(selectedApplication.status)">
                {{ getStatusText(selectedApplication.status) }}
              </span>
            </p>
          </div>
          <div class="detail-item full-width">
            <label>ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ</label>
            <p class="cv-link">
              <i class="fas fa-file-pdf"></i>
              {{ selectedApplication.cv }}
            </p>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="cancel-btn" (click)="closeApplicationDetails()">
          <i class="fas fa-times"></i> ุฅุบูุงู
        </button>
      </div>
    </div>
  </div>

</div>